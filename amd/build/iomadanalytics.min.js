define(["jquery","/report/iomadanalytics/amd/src/Chart.min.js","core/ajax"],function(a,b,c){return{init:function(){a(document).ready(function(){function d(){console.log("refreshGradesGraph"),a.getJSON(i+"graphGradesAllCompany.json",function(b){return a(".country_company input").each(function(){if(this.checked){var c=a("#selectedFilter").val();console.log(c),"all"!=c&&console.log(b[a(this).val()].filters[c])}}),b})}function e(b){a("#"+b).click(function(){a("#"+b).prop("checked")===!0?a(".country-"+b+" input").prop("checked",!0):a(".country-"+b+" input").prop("checked",!1),d()})}function f(){alert("me");var a=c.call([{methodname:"report_iomadanalytics_filters",args:{filters:"pluginname"}}]);a[0].done(function(a){alert("mod_wiki/pluginname is"+a)}).fail(function(a){console.log(a)})}function g(){a("#filters_tab button").each(function(){a(this).html(a("<div>").html(a(this).html()).text()).removeClass("bkgBtn")})}var h=["ID","MY"],i="/report/iomadanalytics/templates/",j="";a.getJSON(i+"graph_grades_all_companies.json",function(a){new b(document.getElementById("chart-grades").getContext("2d"),{type:"bar",data:a,options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]},tooltips:{enabled:!0,mode:"single",callbacks:{label:function(a,b){return b.datasets[a.datasetIndex].label+" : "+a.yLabel+"%"}}}}})}),a.getJSON(i+"graph_progress_all_companies.json",function(c){for(k in c.companies)j="chart-progress-"+c.companies[k].id,a("#progressGraph").append('<div class="col-md-4"><canvas id="'+j+'"></canvas></div>'),new b(document.getElementById(j).getContext("2d"),{type:"pie",data:c.companies[k].graph,options:{legend:!1,title:{text:c.companies[k].company,display:!0,position:"bottom"},tooltips:{enabled:!0,mode:"single",callbacks:{label:function(a,b){return b.labels[a.index].replace("&nbsp;"," ")+" : "+b.datasets[a.datasetIndex].data[a.index]+"%"}}}}})});for(var k=0;k<h.length;k++)e(h[k]);a(".country_company input").change(function(){d()}),a("#btn").click(function(){f()}),a("div.bhoechie-tab-menu>div.list-group>a").click(function(b){b.preventDefault(),a(this).siblings("a.active").removeClass("active"),a(this).addClass("active");var c=a(this).index();a("div.bhoechie-tab>div.bhoechie-tab-content").removeClass("active"),a("div.bhoechie-tab>div.bhoechie-tab-content").eq(c).addClass("active")}),a("#filters_tab button").click(function(){a("#selectedFilter").val(a(this).data("filterid")),g(),a(this).html('<i class="fa fa-check"></i> '+a(this).html()).addClass("bkgBtn"),d()})})}}});